"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9523],{9523:(T,f,l)=>{l.r(f),l.d(f,{DuplicatesPageModule:()=>A});var m=l(6895),u=l(4719),a=l(5616),h=l(8359),g=l(5861),t=l(6738),_=l(3811),Z=l(2982),v=l(8261);const b=["photo"];function C(n,p){if(1&n){const o=t.EpF();t.TgZ(0,"ion-item",10)(1,"ion-thumbnail",0),t._UZ(2,"iframe",11,12),t.qZA(),t.TgZ(4,"ion-list",13),t.NdJ("click",function(){const c=t.CHM(o).$implicit,s=t.oxw(2);return t.KtG(s.moveCamera(+c.controls.lat.value,+c.controls.lng.value))}),t.TgZ(5,"ion-item",10)(6,"ion-label",14),t._uU(7,"name: "),t.qZA(),t._UZ(8,"ion-input",15),t.qZA(),t.TgZ(9,"ion-item",10)(10,"ion-label",14),t._uU(11,"address: "),t.qZA(),t._UZ(12,"ion-input",16),t.qZA(),t.TgZ(13,"ion-item",10)(14,"ion-grid",17)(15,"ion-row",18)(16,"ion-col",19)(17,"ion-label",14),t._uU(18,"route: "),t.qZA(),t._UZ(19,"ion-input",20),t.qZA(),t.TgZ(20,"ion-col",21)(21,"ion-label",14),t._uU(22,"number: "),t.qZA(),t._UZ(23,"ion-input",22),t.qZA()()()(),t.TgZ(24,"ion-item",10)(25,"ion-grid",17)(26,"ion-row",18)(27,"ion-col",19)(28,"ion-label",14),t._uU(29,"neighborhood: "),t.qZA(),t._UZ(30,"ion-input",23),t.qZA(),t.TgZ(31,"ion-col",21)(32,"ion-label",14),t._uU(33,"postal_code: "),t.qZA(),t._UZ(34,"ion-input",24),t.qZA()()()(),t.TgZ(35,"ion-item",10)(36,"ion-grid",17)(37,"ion-row",18)(38,"ion-col",19)(39,"ion-label",14),t._uU(40,"city: "),t.qZA(),t._UZ(41,"ion-input",25),t.qZA(),t.TgZ(42,"ion-col",21)(43,"ion-label",14),t._uU(44,"state: "),t.qZA(),t._UZ(45,"ion-input",26),t.qZA()()()(),t.TgZ(46,"ion-item",10)(47,"ion-grid",17)(48,"ion-row",18)(49,"ion-col",19)(50,"ion-label",14),t._uU(51,"lat: "),t.qZA(),t._UZ(52,"ion-input",27),t.qZA(),t.TgZ(53,"ion-col",28)(54,"ion-label",14),t._uU(55,"lng: "),t.qZA(),t._UZ(56,"ion-input",29),t.qZA()()()(),t.TgZ(57,"ion-item",10)(58,"ion-grid",17)(59,"ion-row",18)(60,"ion-col",19)(61,"ion-label",14),t._uU(62,"must_delete "),t.qZA(),t.TgZ(63,"ion-checkbox",30),t.NdJ("ionChange",function(i){const s=t.CHM(o).index,r=t.oxw(2);return t.KtG(r.convertToNumber(i,"must_delete",s))}),t.qZA()(),t.TgZ(64,"ion-col",28)(65,"ion-label",14),t._uU(66,"possible_duplicate "),t.qZA(),t.TgZ(67,"ion-checkbox",31),t.NdJ("ionChange",function(i){const s=t.CHM(o).index,r=t.oxw(2);return t.KtG(r.convertToNumber(i,"possible_duplicate",s))}),t.qZA()()()()()()()}if(2&n){const o=p.$implicit;t.xp6(2),t.s9C("id",o.controls.id.value),t.xp6(2),t.Q6J("formGroup",o)}}function x(n,p){if(1&n){const o=t.EpF();t.TgZ(0,"div")(1,"div",4),t._UZ(2,"div",5),t.TgZ(3,"div",6)(4,"ion-list",7),t.YNc(5,C,68,2,"ion-item",8),t.qZA(),t.TgZ(6,"ion-button",9),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.onSubmit())}),t._uU(7,"Submit"),t.qZA()()()()}if(2&n){const o=t.oxw();t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(2),t.Q6J("ngForOf",o.stationControls)}}const y=[{path:"",component:(()=>{class n{constructor(o,e,i,c){this.appService=o,this.networkService=e,this.mapService=i,this.fb=c,this.form=this.fb.group({stations:this.fb.array([])}),this.moveCamera=(s,r)=>{console.log(s,r),this.mapService.map.animateCamera({target:{lat:s,lng:r}}),this.mapService.simpleMarker.remove(),this.mapService.addSimpleMarker(s,r)},this.convertToNumber=(s,r,d)=>{this.stations.controls[d].get(r).setValue(s.detail.checked?1:0,{emitEvent:!1})}}ngOnInit(){var o=this;return(0,g.Z)(function*(){o.appService.showLoading(),o.duplicates=(yield o.networkService.getDuplicates()).data;for(let e of o.duplicates){const i=o.fb.group({id:[e.id],place_id:[e.place_id],name:[e.name],address:[e.address],route:[e.route],number:[e.number],neighborhood:[e.neighborhood],city:[e.city],state:[e.state],lat:[e.lat],lng:[e.lng],postal_code:[e.postal_code],must_delete:[e.must_delete],possible_duplicate:[e.possible_duplicate]});o.stations.push(i)}console.log(o.form),o.appService.hideLoading()})()}ngAfterViewInit(){var o=this;this.photoChangesSubscription=this.photos.changes.subscribe(function(){var e=(0,g.Z)(function*(i){if(console.log(i),console.log(i.length),console.log(i._results),i._results.length>0){o.mapService.setKey();for(const c of i._results){const s=o.duplicates.filter(r=>r.id==c.nativeElement.id)[0];c.nativeElement.setAttribute("src",s.pano_id?"https://www.google.com/maps/embed/v1/streetview?key="+o.mapService.keys.release+"&pano="+s.pano_id+"&heading="+s.heading+"&fov=90":"")}yield o.mapService.createMap("map-canvas",o.duplicates[0].lat,o.duplicates[0].lng,"duplicates"),o.mapService.addSimpleMarker(o.duplicates[0].lat,o.duplicates[0].lng)}});return function(i){return e.apply(this,arguments)}}())}ngOnDestroy(){console.log("DESTROY"),this.photoChangesSubscription.unsubscribe()}get stations(){return this.form.controls.stations}get stationControls(){return this.stations.controls}onSubmit(){var o=this;return(0,g.Z)(function*(){console.log(o.form);const e=o.stations.controls.map(c=>{const s=c.controls;let r={place_id:s.place_id.value};for(let d in s)s[d].dirty&&(r[d]=s[d].value);return r});console.log(e);const i=yield o.networkService.updateDuplicates(e);console.log(i),o.networkService.updateStations()})()}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(_.z),t.Y36(Z.S),t.Y36(v.S),t.Y36(u.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-duplicates"]],viewQuery:function(o,e){if(1&o&&t.Gf(b,5),2&o){let i;t.iGM(i=t.CRH())&&(e.photos=i)}},decls:10,vars:1,consts:[["slot","start"],[4,"ngIf"],["id","footer"],["src","//www.profitabledisplayformat.com/watchnew?key=5016b984cb0dea604afd3a1eb085b274","width","320","height","50","frameborder","0","scrolling","no"],[1,"main"],["id","map-canvas",1,"map"],[3,"formGroup"],["formArrayName","stations",1,"station-list"],["class","station-item",4,"ngFor","ngForOf"],[3,"click"],[1,"station-item"],["width","100%","height","200","frameborder","0","loading","lazy","allowfullscreen","","referrerpolicy","no-referrer-when-downgrade",2,"border","0",3,"id"],["photo",""],[1,"control-list",3,"formGroup","click"],[1,"station-label","ion-no-margin"],["type","text","formControlName","name",1,"station-input"],["type","text","formControlName","address",1,"station-input"],[1,"ion-no-padding"],[1,"ion-no-padding","ion-justify-content-between"],[1,"ion-no-padding","ion-justify-content-start","ion-align-items-center"],["type","text","formControlName","route",1,"station-input"],["size","4",1,"ion-no-padding","ion-justify-content-end","ion-align-items-center"],["type","text","formControlName","number",1,"station-input"],["type","text","formControlName","neighborhood",1,"station-input"],["type","text","formControlName","postal_code",1,"station-input"],["type","text","formControlName","city",1,"station-input"],["type","text","formControlName","state",1,"station-input"],["type","text","formControlName","lat",1,"station-input"],[1,"ion-no-padding","ion-justify-content-end","ion-align-items-center"],["type","text","formControlName","lng",1,"station-input"],["formControlName","must_delete",1,"ion-no-margin",3,"ionChange"],["formControlName","possible_duplicate",1,"ion-no-margin",3,"ionChange"]],template:function(o,e){1&o&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3," PostoBarato "),t.qZA(),t.TgZ(4,"ion-buttons",0),t._UZ(5,"ion-back-button"),t.qZA()()(),t.TgZ(6,"ion-content"),t.YNc(7,x,8,2,"div",1),t.qZA(),t.TgZ(8,"ion-footer",2),t._UZ(9,"iframe",3),t.qZA()),2&o&&(t.xp6(7),t.Q6J("ngIf",!e.appService.isLoading))},dependencies:[m.sg,m.O5,u.JJ,u.JL,a.oU,a.YG,a.Sm,a.nz,a.wI,a.W2,a.fr,a.jY,a.Gu,a.pK,a.Ie,a.Q$,a.q_,a.Nd,a.Bs,a.wd,a.sr,a.w,a.j9,a.cs,u.sg,u.u,u.CE],styles:["ion-thumbnail[_ngcontent-%COMP%]{width:500px;height:100%}.main[_ngcontent-%COMP%]{display:flex;flex-direction:row}.map[_ngcontent-%COMP%]{width:500px;height:690px}.station-list[_ngcontent-%COMP%]{height:650px;overflow:scroll}.control-list[_ngcontent-%COMP%]{height:100%}.station-item[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;--min-height:auto}.station-label[_ngcontent-%COMP%]{font-size:10px}.station-input[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;font-size:14px}ion-col[_ngcontent-%COMP%]{display:flex;flex-direction:row}"]}),n})()}];let w=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(y),h.Bz]}),n})(),A=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,u.u5,a.Pc,w,u.UX]}),n})()}}]);