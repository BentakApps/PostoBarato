"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9523],{9523:(A,g,a)=>{a.r(g),a.d(g,{DuplicatesPageModule:()=>C});var m=a(6895),p=a(4719),l=a(5616),f=a(8359),u=a(5861),t=a(6738),h=a(4742),v=a(2982),y=a(8261),b=a(6533),P=a(9455);const S=["photo"];function D(i,c){1&i&&t._UZ(0,"app-db-station",11),2&i&&t.Q6J("formGroupName",c.index)}const Z=[{path:"",component:(()=>{class i{constructor(e,r,n,d){var o=this;this.appService=e,this.networkService=r,this.mapService=n,this.fb=d,this.form=this.fb.group({stations:this.fb.array([])}),this.getDuplicates=(0,u.Z)(function*(){o.appService.showLoading(),o.form=o.fb.group({stations:o.fb.array([])}),o.duplicates=(yield o.networkService.getDuplicates()).data;for(let s of o.duplicates){const x=o.fb.group({id:[s.id],place_id:[s.place_id],name:[s.name],address:[s.address],route:[s.route],number:[s.number],neighborhood:[s.neighborhood],city:[s.city],state:[s.state],postal_code:[s.postal_code],lat:[s.lat],lng:[s.lng],heading:[s.heading],pano_id:[s.pano_id],must_delete:[0],possible_duplicate:[s.possible_duplicate]});o.form.get("stations").controls.push(x)}console.log(o.form),o.duplicates.length>0&&(o.mapService.map||(yield o.mapService.createMap("map-canvas",o.duplicates[0].lat,o.duplicates[0].lng,"duplicates")),o.mapService.addSimpleMarker(o.duplicates[0].lat,o.duplicates[0].lng)),o.appService.hideLoading()})}ngOnInit(){var e=this;return(0,u.Z)(function*(){yield e.getDuplicates()})()}onSubmit(){var e=this;return(0,u.Z)(function*(){console.log(e.form),e.appService.showLoading();const r=e.form.get("stations").controls.map(n=>{let d={place_id:n.get("place_id").value};for(let o in n.controls)n.get(o).dirty&&(d[o]=n.get(o).value);return d}).filter(n=>Object.keys(n).length>1);try{const n=yield e.networkService.postExceptions(r);console.log(n),yield e.networkService.applyExceptions(),yield e.getDuplicates(),e.appService.hideLoading()}catch(n){console.log("ERROR"),console.log(n),console.log(n.response),yield e.appService.errorAlert(n.response.data.error),e.appService.hideLoading()}})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.z),t.Y36(v.S),t.Y36(y.S),t.Y36(p.qu))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-duplicates"]],viewQuery:function(e,r){if(1&e&&t.Gf(S,5),2&e){let n;t.iGM(n=t.CRH())&&(r.photos=n)}},decls:20,vars:4,consts:[["slot","start"],[1,"main"],["id","map-canvas",1,"map"],[3,"formGroup"],["formArrayName","stations",1,"station-list"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"ion-justify-content-between"],["color","warning",3,"click"],["color","primary",3,"click"],["id","footer"],["src","//www.profitabledisplayformat.com/watchnew?key=5016b984cb0dea604afd3a1eb085b274","width","320","height","50","frameborder","0","scrolling","no"],[3,"formGroupName"]],template:function(e,r){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3," PostoBarato "),t.qZA(),t.TgZ(4,"ion-buttons",0),t._UZ(5,"ion-back-button"),t.qZA()()(),t.TgZ(6,"ion-content")(7,"div",1),t._UZ(8,"div",2),t.TgZ(9,"div",3)(10,"ion-list",4),t.YNc(11,D,1,1,"app-db-station",5),t.ALo(12,"toFormArray"),t.qZA(),t.TgZ(13,"ion-row",6)(14,"ion-button",7),t.NdJ("click",function(){return r.getDuplicates()}),t._uU(15,"Reload"),t.qZA(),t.TgZ(16,"ion-button",8),t.NdJ("click",function(){return r.onSubmit()}),t._uU(17,"Submit"),t.qZA()()()()(),t.TgZ(18,"ion-footer",9),t._UZ(19,"iframe",10),t.qZA()),2&e&&(t.xp6(9),t.Q6J("formGroup",r.form),t.xp6(2),t.Q6J("ngForOf",t.lcZ(12,2,r.form.get("stations")).controls))},dependencies:[m.sg,p.JL,l.oU,l.YG,l.Sm,l.W2,l.fr,l.Gu,l.q_,l.Nd,l.wd,l.sr,l.cs,p.sg,p.x0,p.CE,b.b,P.X],styles:["ion-thumbnail[_ngcontent-%COMP%]{width:500px;height:100%}.main[_ngcontent-%COMP%]{display:flex;flex-direction:row}.map[_ngcontent-%COMP%]{width:500px;height:690px}.station-list[_ngcontent-%COMP%]{height:650px;overflow:scroll}.control-list[_ngcontent-%COMP%]{height:100%}.station-item[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;--min-height:auto}.station-label[_ngcontent-%COMP%]{font-size:10px}.station-input[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;font-size:14px}ion-col[_ngcontent-%COMP%]{display:flex;flex-direction:row}"]}),i})()}];let M=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[f.Bz.forChild(Z),f.Bz]}),i})();var O=a(9),w=a(5503);let C=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.ez,p.u5,l.Pc,M,p.UX,O.B,w.D]}),i})()}}]);